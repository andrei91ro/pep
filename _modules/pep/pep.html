

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>pep.pep &mdash; PeP (Enzymatic) Numerical P System simulator 1.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="PeP (Enzymatic) Numerical P System simulator 1.1 documentation" href="../../index.html"/>
        <link rel="up" title="Module code" href="../index.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> PeP (Enzymatic) Numerical P System simulator
          

          
          </a>

          
            
            
              <div class="version">
                1.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../pep_syntax_reference.html">PeP input file syntax reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contact.html">Contact</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">PeP (Enzymatic) Numerical P System simulator</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
      <li>pep.pep</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for pep.pep</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/python3</span>

<span class="kn">import</span> <span class="nn">collections</span>  <span class="c1"># for named tuple &amp;&amp; Counter (multisets)</span>
<span class="kn">import</span> <span class="nn">re</span>  <span class="c1"># for regex</span>
<span class="kn">from</span> <span class="nn">enum</span> <span class="k">import</span> <span class="n">IntEnum</span> <span class="c1"># for enumerations (enum from C)</span>
<span class="kn">import</span> <span class="nn">logging</span> <span class="c1"># for logging functions</span>
<span class="kn">import</span> <span class="nn">random</span> <span class="c1"># for stochastic chosing of programs</span>
<span class="kn">import</span> <span class="nn">time</span> <span class="c1"># for time.time()</span>
<span class="kn">import</span> <span class="nn">math</span> <span class="c1"># for productionFunction evaluation of math functions</span>

<span class="c1">##########################################################################</span>
<span class="c1"># auxiliary definitions</span>
<div class="viewcode-block" id="OperatorType"><a class="viewcode-back" href="../../generated/pep.pep.html#pep.pep.OperatorType">[docs]</a><span class="k">class</span> <span class="nc">OperatorType</span><span class="p">(</span><span class="n">IntEnum</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Enumeration of operator types, ordered by precedence in calculus&quot;&quot;&quot;</span>

    <span class="n">left_brace</span>   <span class="o">=</span> <span class="mi">1</span>
    <span class="c1"># right brace is never added to the postfix stack</span>
    <span class="n">eq</span>           <span class="o">=</span> <span class="mi">2</span> <span class="c1"># a == b</span>
    <span class="n">ne</span>           <span class="o">=</span> <span class="mi">3</span> <span class="c1"># a != b</span>
    <span class="n">lt</span>           <span class="o">=</span> <span class="mi">4</span> <span class="c1"># a &lt; b</span>
    <span class="n">le</span>           <span class="o">=</span> <span class="mi">5</span> <span class="c1"># a &lt;= b</span>
    <span class="n">gt</span>           <span class="o">=</span> <span class="mi">6</span> <span class="c1"># a &gt; b</span>
    <span class="n">ge</span>           <span class="o">=</span> <span class="mi">7</span> <span class="c1"># a &gt;= b</span>
    <span class="n">add</span>          <span class="o">=</span> <span class="mi">8</span>
    <span class="n">subtract</span>     <span class="o">=</span> <span class="mi">9</span>
    <span class="n">multiply</span>     <span class="o">=</span> <span class="mi">10</span>
    <span class="n">divide</span>       <span class="o">=</span> <span class="mi">11</span>
    <span class="n">power</span>        <span class="o">=</span> <span class="mi">12</span>
    <span class="n">negate</span>       <span class="o">=</span> <span class="mi">13</span>

    <span class="c1"># trigonometric functions</span>
    <span class="c1"># Functions that end with &#39;d&#39; use degrees instead of radians</span>
    <span class="n">sin</span>          <span class="o">=</span> <span class="mi">14</span>
    <span class="n">sind</span>         <span class="o">=</span> <span class="mi">15</span>
    <span class="n">asin</span>         <span class="o">=</span> <span class="mi">16</span>
    <span class="n">asind</span>        <span class="o">=</span> <span class="mi">17</span>

    <span class="n">cos</span>          <span class="o">=</span> <span class="mi">18</span>
    <span class="n">cosd</span>         <span class="o">=</span> <span class="mi">19</span>
    <span class="n">acos</span>         <span class="o">=</span> <span class="mi">20</span>
    <span class="n">acosd</span>        <span class="o">=</span> <span class="mi">21</span>

    <span class="n">tan</span>          <span class="o">=</span> <span class="mi">22</span>
    <span class="n">tand</span>         <span class="o">=</span> <span class="mi">23</span>
    <span class="n">atan</span>         <span class="o">=</span> <span class="mi">24</span>
    <span class="n">atand</span>        <span class="o">=</span> <span class="mi">25</span>
    <span class="n">atan2</span>        <span class="o">=</span> <span class="mi">26</span>
    <span class="n">atan2d</span>       <span class="o">=</span> <span class="mi">27</span>

    <span class="n">cot</span>          <span class="o">=</span> <span class="mi">28</span>
    <span class="n">cotd</span>         <span class="o">=</span> <span class="mi">29</span>
    <span class="n">acot</span>         <span class="o">=</span> <span class="mi">30</span>
    <span class="n">acotd</span>        <span class="o">=</span> <span class="mi">31</span>

    <span class="c1"># generic functions</span>
    <span class="n">sqrt</span>         <span class="o">=</span> <span class="mi">32</span>
    <span class="nb">abs</span>          <span class="o">=</span> <span class="mi">33</span>
    <span class="n">log</span>          <span class="o">=</span> <span class="mi">34</span> <span class="c1"># base e (natural) logarithm</span>
    <span class="n">log10</span>        <span class="o">=</span> <span class="mi">35</span> <span class="c1"># base 10 logarithm</span>
    <span class="n">log2</span>         <span class="o">=</span> <span class="mi">36</span> <span class="c1"># base 2 logarithm</span></div>

<span class="c1"># end class OperatorType</span>

<span class="n">dictOperatorTypes</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;OPERATOR_ADD&#39;</span><span class="p">:</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">add</span><span class="p">,</span>
        <span class="s1">&#39;OPERATOR_SUBTRACT&#39;</span><span class="p">:</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">subtract</span><span class="p">,</span>
        <span class="s1">&#39;OPERATOR_NEGATE&#39;</span><span class="p">:</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">negate</span><span class="p">,</span>
        <span class="s1">&#39;OPERATOR_MULTIPLY&#39;</span><span class="p">:</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">multiply</span><span class="p">,</span>
        <span class="s1">&#39;OPERATOR_DIVIDE&#39;</span><span class="p">:</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">divide</span><span class="p">,</span>
        <span class="s1">&#39;OPERATOR_POWER&#39;</span><span class="p">:</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">power</span><span class="p">,</span>
        <span class="s1">&#39;OPERATOR_EQUAL&#39;</span><span class="p">:</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">eq</span><span class="p">,</span>
        <span class="s1">&#39;OPERATOR_NOT_EQUAL&#39;</span><span class="p">:</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">ne</span><span class="p">,</span>
        <span class="s1">&#39;OPERATOR_LESS_THAN&#39;</span><span class="p">:</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">lt</span><span class="p">,</span>
        <span class="s1">&#39;OPERATOR_LESS_EQUAL&#39;</span><span class="p">:</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">le</span><span class="p">,</span>
        <span class="s1">&#39;OPERATOR_GREATER_THAN&#39;</span><span class="p">:</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">gt</span><span class="p">,</span>
        <span class="s1">&#39;OPERATOR_GREATER_EQUAL&#39;</span><span class="p">:</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">ge</span><span class="p">,</span>

        <span class="s1">&#39;FUNCTION_SIN&#39;</span><span class="p">:</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">sin</span><span class="p">,</span>
        <span class="s1">&#39;FUNCTION_SIND&#39;</span><span class="p">:</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">sind</span><span class="p">,</span>
        <span class="s1">&#39;FUNCTION_ASIN&#39;</span><span class="p">:</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">asin</span><span class="p">,</span>
        <span class="s1">&#39;FUNCTION_ASIND&#39;</span><span class="p">:</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">asind</span><span class="p">,</span>
        <span class="s1">&#39;FUNCTION_COS&#39;</span><span class="p">:</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">cos</span><span class="p">,</span>
        <span class="s1">&#39;FUNCTION_COSD&#39;</span><span class="p">:</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">cosd</span><span class="p">,</span>
        <span class="s1">&#39;FUNCTION_ACOS&#39;</span><span class="p">:</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">acos</span><span class="p">,</span>
        <span class="s1">&#39;FUNCTION_ACOSD&#39;</span><span class="p">:</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">acosd</span><span class="p">,</span>
        <span class="s1">&#39;FUNCTION_TAN&#39;</span><span class="p">:</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">tan</span><span class="p">,</span>
        <span class="s1">&#39;FUNCTION_TAND&#39;</span><span class="p">:</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">tand</span><span class="p">,</span>
        <span class="s1">&#39;FUNCTION_ATAN&#39;</span><span class="p">:</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">atan</span><span class="p">,</span>
        <span class="s1">&#39;FUNCTION_ATAND&#39;</span><span class="p">:</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">atand</span><span class="p">,</span>
        <span class="s1">&#39;FUNCTION_ATAN2&#39;</span><span class="p">:</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">atan2</span><span class="p">,</span>
        <span class="s1">&#39;FUNCTION_ATAN2D&#39;</span><span class="p">:</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">atan2d</span><span class="p">,</span>
        <span class="s1">&#39;FUNCTION_COT&#39;</span><span class="p">:</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">cot</span><span class="p">,</span>
        <span class="s1">&#39;FUNCTION_COTD&#39;</span><span class="p">:</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">cotd</span><span class="p">,</span>
        <span class="s1">&#39;FUNCTION_ACOT&#39;</span><span class="p">:</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">acot</span><span class="p">,</span>
        <span class="s1">&#39;FUNCTION_ACOTD&#39;</span><span class="p">:</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">acotd</span><span class="p">,</span>

        <span class="s1">&#39;FUNCTION_SQRT&#39;</span><span class="p">:</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">sqrt</span><span class="p">,</span>
        <span class="s1">&#39;FUNCTION_ABS&#39;</span><span class="p">:</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">abs</span><span class="p">,</span>
        <span class="s1">&#39;FUNCTION_LOG&#39;</span><span class="p">:</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">log</span><span class="p">,</span>
        <span class="s1">&#39;FUNCTION_LOG10&#39;</span><span class="p">:</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">log10</span><span class="p">,</span>
        <span class="s1">&#39;FUNCTION_LOG2&#39;</span><span class="p">:</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">log2</span><span class="p">,</span>
        <span class="p">}</span>

<span class="c1"># tuple used to describe parsed data</span>
<span class="n">Token</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;Token&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">&#39;line&#39;</span><span class="p">,</span> <span class="s1">&#39;column&#39;</span><span class="p">])</span>

<span class="c1">##########################################################################</span>
<span class="c1"># class definitions</span>

<div class="viewcode-block" id="NumericalPsystem"><a class="viewcode-back" href="../../generated/pep.pep.NumericalPsystem.html#pep.pep.NumericalPsystem">[docs]</a><span class="k">class</span> <span class="nc">NumericalPsystem</span><span class="p">():</span>

    <span class="sd">&quot;&quot;&quot;Numerical P systems class</span>

<span class="sd">    :ivar array(str) H: array of strings (names of membranes)</span>
<span class="sd">    :ivar dict membranes: map (dictioanry) between String membrane_name: Membrane object</span>
<span class="sd">    :ivar MembraneStructure structure: MembraneStructure object (list of structural elements) [1 [2 ]2 ]1</span>
<span class="sd">    :ivar list(Pobject) variables: list of Pobjects that appear throughtout the P system</span>
<span class="sd">    :ivar list(Pobject) enzymes: list of enzyme Pobjects that appear throughtout the P system</span>
<span class="sd">    :ivar file csvFile: file used for Comma Separated Value output</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="NumericalPsystem.__init__"><a class="viewcode-back" href="../../generated/pep.pep.NumericalPsystem.html#pep.pep.NumericalPsystem.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">H</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">membranes</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">structure</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">variables</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">enzymes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">csvFile</span> <span class="o">=</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="NumericalPsystem.runSimulationStep"><a class="viewcode-back" href="../../generated/pep.pep.NumericalPsystem.html#pep.pep.NumericalPsystem.runSimulationStep">[docs]</a>    <span class="k">def</span> <span class="nf">runSimulationStep</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Runs 1 simulation step consisting of executing one program (production &amp; dispersion functions) for all membranes that have programs</span>
<span class="sd">        If a membrane has more than one program, one is chosen randomly for execution&quot;&quot;&quot;</span>

        <span class="c1"># production phase for all membranes</span>
        <span class="k">for</span> <span class="n">membraneName</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="p">:</span>
            <span class="n">membrane</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">membranes</span><span class="p">[</span><span class="n">membraneName</span><span class="p">]</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">membrane</span><span class="o">.</span><span class="n">programs</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Production for membrane </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">membraneName</span><span class="p">)</span>

            <span class="c1"># if this membrane does not use enzymes</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">membrane</span><span class="o">.</span><span class="n">enzymes</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
                <span class="n">membrane</span><span class="o">.</span><span class="n">chosenProgramNr</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">membrane</span><span class="o">.</span><span class="n">programs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">membrane</span><span class="o">.</span><span class="n">programs</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">membrane</span><span class="o">.</span><span class="n">chosenProgramNr</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">prgNr</span><span class="p">,</span> <span class="n">prg</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">membrane</span><span class="o">.</span><span class="n">programs</span><span class="p">):</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">prg</span><span class="o">.</span><span class="n">isActivatedByEnzyme</span><span class="p">()):</span>
                        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Program </span><span class="si">%d</span><span class="s2"> activated by enzyme </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prgNr</span><span class="p">,</span> <span class="n">prg</span><span class="o">.</span><span class="n">enzyme</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
                        <span class="n">membrane</span><span class="o">.</span><span class="n">chosenProgramNr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prgNr</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># if this membrane does not use enzymes</span>
                <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">membrane</span><span class="o">.</span><span class="n">enzymes</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
                    <span class="c1"># produce a new value</span>
                    <span class="n">membrane</span><span class="o">.</span><span class="n">newValue</span> <span class="o">=</span> <span class="n">membrane</span><span class="o">.</span><span class="n">programs</span><span class="p">[</span><span class="n">membrane</span><span class="o">.</span><span class="n">chosenProgramNr</span><span class="p">]</span><span class="o">.</span><span class="n">prodFunction</span><span class="o">.</span><span class="n">evaluate</span><span class="p">()</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">membrane</span><span class="o">.</span><span class="n">newValue</span> <span class="o">=</span> <span class="p">[</span><span class="n">membrane</span><span class="o">.</span><span class="n">programs</span><span class="p">[</span><span class="n">prgNr</span><span class="p">]</span><span class="o">.</span><span class="n">prodFunction</span><span class="o">.</span><span class="n">evaluate</span><span class="p">()</span> <span class="k">for</span> <span class="n">prgNr</span> <span class="ow">in</span> <span class="n">membrane</span><span class="o">.</span><span class="n">chosenProgramNr</span> <span class="p">]</span>
            <span class="k">except</span> <span class="ne">RuntimeError</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Error encountered during production function of membrane </span><span class="si">%s</span><span class="s2">, program </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">membraneName</span><span class="p">,</span> <span class="n">membrane</span><span class="o">.</span><span class="n">chosenProgramNr</span><span class="p">))</span>
                <span class="c1"># re-raise the exception to stop the simulator</span>
                <span class="k">raise</span>

        <span class="c1">## reset variable phase</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Resetting all variables that are part of production functions to 0&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">variable</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">variable</span><span class="o">.</span><span class="n">wasConsumed</span><span class="p">):</span>
                <span class="n">variable</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">variable</span><span class="o">.</span><span class="n">wasConsumed</span> <span class="o">=</span> <span class="kc">False</span> <span class="c1"># if the program it is part of will be executed again, it will be marked as consumed</span>
        <span class="c1">## reset enzymes phase</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Resetting all enzymes that are part of production functions to 0&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">enzyme</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">enzymes</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">enzyme</span><span class="o">.</span><span class="n">wasConsumed</span><span class="p">):</span>
                <span class="n">enzyme</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">enzyme</span><span class="o">.</span><span class="n">wasConsumed</span> <span class="o">=</span> <span class="kc">False</span> <span class="c1"># if the program it is part of will be executed again, it will be marked as consumed</span>

        <span class="c1"># distribution phase for all membranes</span>
        <span class="k">for</span> <span class="n">membraneName</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="p">:</span>
            <span class="n">membrane</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">membranes</span><span class="p">[</span><span class="n">membraneName</span><span class="p">]</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">membrane</span><span class="o">.</span><span class="n">programs</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="c1"># if this membrane uses enzymes (that allow multiple program execution)</span>
            <span class="c1"># and no program is active</span>
            <span class="k">elif</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">membrane</span><span class="o">.</span><span class="n">chosenProgramNr</span><span class="p">)</span> <span class="o">==</span> <span class="nb">list</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">membrane</span><span class="o">.</span><span class="n">chosenProgramNr</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
                <span class="k">continue</span>

            <span class="c1"># if this membrane does not use enzymes</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">membrane</span><span class="o">.</span><span class="n">chosenProgramNr</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span><span class="p">):</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Distribution for membrane </span><span class="si">%s</span><span class="s2"> of unitary value </span><span class="si">%.02f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span>
                    <span class="n">membraneName</span><span class="p">,</span>
                    <span class="n">membrane</span><span class="o">.</span><span class="n">newValue</span> <span class="o">/</span> <span class="n">membrane</span><span class="o">.</span><span class="n">programs</span><span class="p">[</span><span class="n">membrane</span><span class="o">.</span><span class="n">chosenProgramNr</span><span class="p">]</span><span class="o">.</span><span class="n">distribFunction</span><span class="o">.</span><span class="n">proportionTotal</span><span class="p">))</span>
                <span class="c1"># distribute the previously produced value</span>
                <span class="n">membrane</span><span class="o">.</span><span class="n">programs</span><span class="p">[</span><span class="n">membrane</span><span class="o">.</span><span class="n">chosenProgramNr</span><span class="p">]</span><span class="o">.</span><span class="n">distribFunction</span><span class="o">.</span><span class="n">distribute</span><span class="p">(</span><span class="n">membrane</span><span class="o">.</span><span class="n">newValue</span><span class="p">)</span>

            <span class="c1"># if this membrane uses enzymes (that allow multiple program execution)</span>
            <span class="k">elif</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">membrane</span><span class="o">.</span><span class="n">chosenProgramNr</span><span class="p">)</span> <span class="o">==</span> <span class="nb">list</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">membrane</span><span class="o">.</span><span class="n">chosenProgramNr</span><span class="p">)):</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Distribution for membrane </span><span class="si">%s</span><span class="s2"> program </span><span class="si">%d</span><span class="s2"> of unitary value </span><span class="si">%.02f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span>
                        <span class="n">membraneName</span><span class="p">,</span>
                        <span class="n">membrane</span><span class="o">.</span><span class="n">chosenProgramNr</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                        <span class="n">membrane</span><span class="o">.</span><span class="n">newValue</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">membrane</span><span class="o">.</span><span class="n">programs</span><span class="p">[</span><span class="n">membrane</span><span class="o">.</span><span class="n">chosenProgramNr</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">distribFunction</span><span class="o">.</span><span class="n">proportionTotal</span><span class="p">))</span>
                    <span class="c1"># distribute the previously produced value</span>
                    <span class="n">membrane</span><span class="o">.</span><span class="n">programs</span><span class="p">[</span><span class="n">membrane</span><span class="o">.</span><span class="n">chosenProgramNr</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">distribFunction</span><span class="o">.</span><span class="n">distribute</span><span class="p">(</span><span class="n">membrane</span><span class="o">.</span><span class="n">newValue</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Simulation step finished succesfully&quot;</span><span class="p">)</span></div>
    <span class="c1"># end runSimulationStep()</span>

<div class="viewcode-block" id="NumericalPsystem.simulate"><a class="viewcode-back" href="../../generated/pep.pep.NumericalPsystem.html#pep.pep.NumericalPsystem.simulate">[docs]</a>    <span class="k">def</span> <span class="nf">simulate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stepByStepConfirm</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">printEachSystemState</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">maxSteps</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">maxTime</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Simulates the numericP system until one of the imposed limits is reached</span>

<span class="sd">        :stepByStepConfirm: True / False - whether or not to wait for confirmation before starting the next simulation step</span>
<span class="sd">        :printEachSystemState: True / False - whether or not to print the P system state after the execution ofeach simulation step</span>
<span class="sd">        :maxSteps: The maximmum number of simulation steps to run</span>
<span class="sd">        :maxTime: The maximum time span that the entire simulation can last&quot;&quot;&quot;</span>

        <span class="n">currentStep</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
         <span class="c1"># time.time() == time in seconds since the Epoch</span>
        <span class="n">startTime</span> <span class="o">=</span> <span class="n">currentTime</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">();</span>
        <span class="n">finalTime</span> <span class="o">=</span> <span class="n">currentTime</span> <span class="o">+</span> <span class="n">maxTime</span>

        <span class="c1"># write initial system state into csv file</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">csvFile</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">csvFile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, ,</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="n">currentStep</span><span class="p">,</span>
                <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">var</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">system</span><span class="o">.</span><span class="n">variables</span><span class="p">]),</span>
                <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">enz</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">enz</span> <span class="ow">in</span> <span class="n">system</span><span class="o">.</span><span class="n">enzymes</span><span class="p">])))</span>

        <span class="k">while</span> <span class="p">(</span><span class="kc">True</span><span class="p">):</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Starting simulation step </span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">currentStep</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">runSimulationStep</span><span class="p">()</span>
            <span class="n">currentTime</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">csvFile</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">csvFile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, ,</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span>
                        <span class="n">currentStep</span><span class="p">,</span>
                        <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">var</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">system</span><span class="o">.</span><span class="n">variables</span><span class="p">]),</span>
                        <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">enz</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">enz</span> <span class="ow">in</span> <span class="n">system</span><span class="o">.</span><span class="n">enzymes</span><span class="p">])))</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">printEachSystemState</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">print</span><span class="p">()</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">stepByStepConfirm</span><span class="p">):</span>
                <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Press ENTER to continue&quot;</span><span class="p">)</span>

            <span class="c1"># if there is a maximum time limit set and it was exceded</span>
            <span class="k">if</span> <span class="p">((</span><span class="n">currentTime</span> <span class="o">&gt;=</span> <span class="n">finalTime</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">maxTime</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)):</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Maximum time limit exceeded; Simulation stopped&quot;</span><span class="p">)</span>
                <span class="k">break</span> <span class="c1"># stop the simulation</span>

            <span class="c1"># if there is a maximum step limit set and it was exceded</span>
            <span class="k">if</span> <span class="p">((</span><span class="n">currentStep</span> <span class="o">&gt;=</span> <span class="n">maxSteps</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">maxSteps</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)):</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Maximum number of simulation steps exceeded; Simulation stopped&quot;</span><span class="p">)</span>
                <span class="k">break</span> <span class="c1"># stop the simulation</span>

            <span class="n">currentStep</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="c1">#end while loop</span>

        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Simulation finished succesfully after </span><span class="si">%d</span><span class="s2"> steps and </span><span class="si">%f</span><span class="s2"> seconds; End state below:&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">currentStep</span><span class="p">,</span> <span class="n">currentTime</span> <span class="o">-</span> <span class="n">startTime</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">print</span><span class="p">()</span></div>

    <span class="c1"># end simulate()</span>

<div class="viewcode-block" id="NumericalPsystem.print"><a class="viewcode-back" href="../../generated/pep.pep.NumericalPsystem.html#pep.pep.NumericalPsystem.print">[docs]</a>    <span class="k">def</span> <span class="nf">print</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indentSpaces</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">toString</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">withPrograms</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Print the entire Numerical P system with a given indentation level</span>

<span class="sd">        :indentSpaces: number of spaces used for indentation</span>
<span class="sd">        :toString: write to a string instead of stdout</span>
<span class="sd">        :withPrograms: print out the programs from each membrane, along with the membrane variables</span>
<span class="sd">        :returns: string print of the membrane if toString = True otherwise returns None &quot;&quot;&quot;</span>

        <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;num_ps = {</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">for</span> <span class="n">membraneName</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="p">:</span>
            <span class="n">membrane</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">membranes</span><span class="p">[</span><span class="n">membraneName</span><span class="p">]</span>
            <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="n">indentSpaces</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">:</span><span class="se">\n</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">membraneName</span><span class="p">,</span> <span class="n">membrane</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">indentSpaces</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="n">toString</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">withPrograms</span><span class="o">=</span><span class="n">withPrograms</span><span class="p">))</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;}</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">toString</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">result</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>
    <span class="c1"># end print()</span>

<div class="viewcode-block" id="NumericalPsystem.openCsvFile"><a class="viewcode-back" href="../../generated/pep.pep.NumericalPsystem.html#pep.pep.NumericalPsystem.openCsvFile">[docs]</a>    <span class="k">def</span> <span class="nf">openCsvFile</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Opens a .csv (Comma Separated Value) file where the values of all variables and enzymes are printed at each simulation step</span>
<span class="sd">        The output file is named using the pattern pep_DAY-MONTH-YEAR_HOUR-MINUTE-SECOND.csv&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">csvFile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;pep_</span><span class="si">%s</span><span class="s2">.csv&quot;</span> <span class="o">%</span> <span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">-%m-%Y_%H-%M-%S&quot;</span><span class="p">),</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">csvFile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;PeP csv output. Format = STEP_NR VARIABLE_COLUMNS EMPTY_COLUMN ENZYME_COLUMNS</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">csvFile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;step, </span><span class="si">%s</span><span class="s2">, ,</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">var</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">system</span><span class="o">.</span><span class="n">variables</span><span class="p">]),</span>
                <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">enz</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">enz</span> <span class="ow">in</span> <span class="n">system</span><span class="o">.</span><span class="n">enzymes</span><span class="p">])))</span></div></div>
    <span class="c1"># end openCsvFile()</span>
<span class="c1"># end class NumericalPsystem</span>

<div class="viewcode-block" id="MembraneStructure"><a class="viewcode-back" href="../../generated/pep.pep.MembraneStructure.html#pep.pep.MembraneStructure">[docs]</a><span class="k">class</span> <span class="nc">MembraneStructure</span><span class="p">(</span><span class="nb">list</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;P system membrane structure (list of structural elements)&quot;&quot;&quot;</span>

<div class="viewcode-block" id="MembraneStructure.__init__"><a class="viewcode-back" href="../../generated/pep.pep.MembraneStructure.html#pep.pep.MembraneStructure.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">list</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div></div>
<span class="c1"># end class MembraneStructure</span>

<div class="viewcode-block" id="Membrane"><a class="viewcode-back" href="../../generated/pep.pep.Membrane.html#pep.pep.Membrane">[docs]</a><span class="k">class</span> <span class="nc">Membrane</span><span class="p">():</span>

    <span class="sd">&quot;&quot;&quot;Membrane class, that can contain other membranes or be part of another membrane</span>

<span class="sd">    :ivar list(Pobject) variables: array of P objects</span>
<span class="sd">    :ivar list(Program) programs: list of Program objects</span>
<span class="sd">    :ivar int|list chosenProgramNr: the program nr that was chosen for execution OR array of chosen program numbers when enzymes are used</span>
<span class="sd">    :ivar double|list(double) newValue: the value that was produced during the previous production phase OR array of values when using enzymes</span>
<span class="sd">    :ivar list(Pobject) enzymes: array of enzyme P objects</span>
<span class="sd">    :ivar Membrane parent: parent membrane (Membrane object)</span>
<span class="sd">    :ivar dict children: map (dictioanry) between String membrane_name: Membrane object</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="Membrane.__init__"><a class="viewcode-back" href="../../generated/pep.pep.Membrane.html#pep.pep.Membrane.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parentMembrane</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">variables</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">programs</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">chosenProgramNr</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">newValue</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">enzymes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parentMembrane</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">children</span> <span class="o">=</span> <span class="p">{}</span></div>


<div class="viewcode-block" id="Membrane.print"><a class="viewcode-back" href="../../generated/pep.pep.Membrane.html#pep.pep.Membrane.print">[docs]</a>    <span class="k">def</span> <span class="nf">print</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indentSpaces</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">toString</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">withPrograms</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Print a membrane with a given indentation level</span>

<span class="sd">        :indentSpaces: number of spaces used for indentation</span>
<span class="sd">        :toString: write to a string instead of stdout</span>
<span class="sd">        :withPrograms: print out the programs from each membrane, along with the membrane variables</span>
<span class="sd">        :returns: string print of the membrane if toString = True otherwise returns None &quot;&quot;&quot;</span>

        <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="n">indentSpaces</span>

        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;var = {&quot;</span>
        <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot; </span><span class="si">%s</span><span class="s2">: </span><span class="si">%.2f</span><span class="s2">, &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">var</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">var</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;}</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="n">indentSpaces</span> <span class="o">+</span> <span class="s2">&quot;E = {&quot;</span>
        <span class="k">for</span> <span class="n">enz</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">enzymes</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot; </span><span class="si">%s</span><span class="s2">: </span><span class="si">%.2f</span><span class="s2">, &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">enz</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">enz</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;}</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">withPrograms</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">program</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">programs</span><span class="p">):</span>
                <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="n">indentSpaces</span> <span class="o">+</span> <span class="s2">&quot;pr_</span><span class="si">%d</span><span class="s2"> = { </span><span class="si">%s</span><span class="s2"> }</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">program</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">indentSpaces</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">toString</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">toString</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">result</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div></div>
    <span class="c1"># end print()</span>
<span class="c1"># end class Membrane</span>

<div class="viewcode-block" id="Program"><a class="viewcode-back" href="../../generated/pep.pep.Program.html#pep.pep.Program">[docs]</a><span class="k">class</span> <span class="nc">Program</span><span class="p">():</span>

    <span class="sd">&quot;&quot;&quot;Program class</span>

<span class="sd">    :ivar ProductionFunction prodFunction: ProductionFunction object</span>
<span class="sd">    :ivar DistributionFunction distribFunction: DistributionFunction object</span>
<span class="sd">    :ivar Pobject enzyme: Pobject if an enzyme is used for this program</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="Program.__init__"><a class="viewcode-back" href="../../generated/pep.pep.Program.html#pep.pep.Program.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prodFunction</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">distribFunction</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">enzyme</span> <span class="o">=</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="Program.print"><a class="viewcode-back" href="../../generated/pep.pep.Program.html#pep.pep.Program.print">[docs]</a>    <span class="k">def</span> <span class="nf">print</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indentSpaces</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">toString</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Print a program with a given indentation level</span>

<span class="sd">        :indentSpaces: number of spaces used for indentation</span>
<span class="sd">        :toString: write to a string instead of stdout</span>
<span class="sd">        :returns: string print of the rule if toString = True otherwise returns None &quot;&quot;&quot;</span>

        <span class="n">enzymeCondition</span> <span class="o">=</span> <span class="s2">&quot;  -&gt;  &quot;</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">enzyme</span><span class="p">)</span> <span class="o">!=</span> <span class="n">Pobject</span> <span class="k">else</span> <span class="s2">&quot;  [&quot;</span> <span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">enzyme</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; -&gt; ]  &quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="n">indentSpaces</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">prodFunction</span><span class="o">.</span><span class="n">infixExpression</span> <span class="o">+</span> <span class="n">enzymeCondition</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">distribFunction</span><span class="o">.</span><span class="n">expression</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">toString</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">result</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>
    <span class="c1"># end print()</span>

<div class="viewcode-block" id="Program.isActivatedByEnzyme"><a class="viewcode-back" href="../../generated/pep.pep.Program.html#pep.pep.Program.isActivatedByEnzyme">[docs]</a>    <span class="k">def</span> <span class="nf">isActivatedByEnzyme</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Checks whether the production function activation condition Enzyme &gt; min(PROD_FUNCTION_VARIABLES) is true</span>
<span class="sd">        :returns: True / False&quot;&quot;&quot;</span>

        <span class="n">minVarValue</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">prodItem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">prodFunction</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>
            <span class="c1"># only P object variables are considered</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">prodItem</span><span class="p">)</span> <span class="o">==</span> <span class="n">Pobject</span><span class="p">):</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">minVarValue</span> <span class="o">==</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">minVarValue</span> <span class="o">&gt;</span> <span class="n">prodItem</span><span class="o">.</span><span class="n">value</span><span class="p">):</span>
                    <span class="n">minVarValue</span> <span class="o">=</span> <span class="n">prodItem</span><span class="o">.</span><span class="n">value</span>

        <span class="c1"># no variables are present in the production function</span>
        <span class="c1"># so the production function is active</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">minVarValue</span> <span class="o">==</span> <span class="kc">None</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">True</span>

        <span class="c1"># the activation condition holds</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">enzyme</span><span class="o">.</span><span class="n">value</span> <span class="o">&gt;</span> <span class="n">minVarValue</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">True</span>

        <span class="k">return</span> <span class="kc">False</span></div></div>
    <span class="c1"># end isActivatedByEnzyme()</span>

<span class="c1"># end class Program</span>

<div class="viewcode-block" id="ProductionFunction"><a class="viewcode-back" href="../../generated/pep.pep.ProductionFunction.html#pep.pep.ProductionFunction">[docs]</a><span class="k">class</span> <span class="nc">ProductionFunction</span><span class="p">():</span>

    <span class="sd">&quot;&quot;&quot;Production function class that stores expressions using the postfix (reversed polish) form</span>

<span class="sd">    :ivar str infixExpression: string representation of the original expression from the input file (written in infix form)</span>
<span class="sd">    :ivar list postfixStack: stack of operands and operators (auxiliary for postfix form)</span>
<span class="sd">    :ivar list items: list of operands and operators written in postfix (reverse polish) form</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="ProductionFunction.__init__"><a class="viewcode-back" href="../../generated/pep.pep.ProductionFunction.html#pep.pep.ProductionFunction.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">infixExpression</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">items</span> <span class="o">=</span> <span class="p">[]</span></div>

<div class="viewcode-block" id="ProductionFunction.evaluate"><a class="viewcode-back" href="../../generated/pep.pep.ProductionFunction.html#pep.pep.ProductionFunction.evaluate">[docs]</a>    <span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Evaluates the postfix form of a production function and returns the computed value.</span>
<span class="sd">        During the evaluation, Pobject references are replaced with their value.</span>
<span class="sd">        :returns: the computed value of the production function, as a numeric value&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>
            <span class="c1"># numeric values get added on the stack</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="nb">float</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

            <span class="c1"># the value of Pobjects is added to the stack</span>
            <span class="k">elif</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="n">Pobject</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
                <span class="c1"># mark this Pobject as consummed</span>
                <span class="n">item</span><span class="o">.</span><span class="n">wasConsumed</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="c1"># (unary) operators (single parameter functions) require that one value is popped and the result is added back to the stack</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">item</span> <span class="o">==</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">sin</span><span class="p">):</span>
                <span class="c1"># evaluate the function</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">pop</span><span class="p">())</span> <span class="p">)</span>

            <span class="k">elif</span> <span class="p">(</span><span class="n">item</span> <span class="o">==</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">sind</span><span class="p">):</span>
                <span class="c1"># evaluate the function</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">pop</span><span class="p">()))</span> <span class="p">)</span>

            <span class="k">elif</span> <span class="p">(</span><span class="n">item</span> <span class="o">==</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">asin</span><span class="p">):</span>
                <span class="c1"># evaluate the function</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">math</span><span class="o">.</span><span class="n">asin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">pop</span><span class="p">())</span> <span class="p">)</span>

            <span class="k">elif</span> <span class="p">(</span><span class="n">item</span> <span class="o">==</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">asind</span><span class="p">):</span>
                <span class="c1"># evaluate the function</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">math</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">asin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">pop</span><span class="p">()))</span> <span class="p">)</span>

            <span class="k">elif</span> <span class="p">(</span><span class="n">item</span> <span class="o">==</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">cos</span><span class="p">):</span>
                <span class="c1"># evaluate the function</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">pop</span><span class="p">())</span> <span class="p">)</span>

            <span class="k">elif</span> <span class="p">(</span><span class="n">item</span> <span class="o">==</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">cosd</span><span class="p">):</span>
                <span class="c1"># evaluate the function</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">pop</span><span class="p">()))</span> <span class="p">)</span>

            <span class="k">elif</span> <span class="p">(</span><span class="n">item</span> <span class="o">==</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">acos</span><span class="p">):</span>
                <span class="c1"># evaluate the function</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">math</span><span class="o">.</span><span class="n">acos</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">pop</span><span class="p">())</span> <span class="p">)</span>

            <span class="k">elif</span> <span class="p">(</span><span class="n">item</span> <span class="o">==</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">acosd</span><span class="p">):</span>
                <span class="c1"># evaluate the function</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">math</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">acos</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">pop</span><span class="p">()))</span> <span class="p">)</span>

            <span class="k">elif</span> <span class="p">(</span><span class="n">item</span> <span class="o">==</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">tan</span><span class="p">):</span>
                <span class="c1"># evaluate the function</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">math</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">pop</span><span class="p">())</span> <span class="p">)</span>

            <span class="k">elif</span> <span class="p">(</span><span class="n">item</span> <span class="o">==</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">tand</span><span class="p">):</span>
                <span class="c1"># evaluate the function</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">math</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">pop</span><span class="p">()))</span> <span class="p">)</span>

            <span class="k">elif</span> <span class="p">(</span><span class="n">item</span> <span class="o">==</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">atan</span><span class="p">):</span>
                <span class="c1"># evaluate the function</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">math</span><span class="o">.</span><span class="n">atan</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">pop</span><span class="p">())</span> <span class="p">)</span>

            <span class="k">elif</span> <span class="p">(</span><span class="n">item</span> <span class="o">==</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">atand</span><span class="p">):</span>
                <span class="c1"># evaluate the function</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">math</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">atan</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">pop</span><span class="p">()))</span> <span class="p">)</span>

            <span class="k">elif</span> <span class="p">(</span><span class="n">item</span> <span class="o">==</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">cot</span><span class="p">):</span>
                <span class="c1"># determine cot() from tan()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">pop</span><span class="p">())</span> <span class="p">)</span>

            <span class="k">elif</span> <span class="p">(</span><span class="n">item</span> <span class="o">==</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">cotd</span><span class="p">):</span>
                <span class="c1"># evaluate the function</span>
                <span class="c1"># determine cot() from tan()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">pop</span><span class="p">()))</span> <span class="p">)</span>

            <span class="k">elif</span> <span class="p">(</span><span class="n">item</span> <span class="o">==</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">acot</span><span class="p">):</span>
                <span class="c1"># evaluate the function</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">math</span><span class="o">.</span><span class="n">atan</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">pop</span><span class="p">())</span> <span class="p">)</span>

            <span class="k">elif</span> <span class="p">(</span><span class="n">item</span> <span class="o">==</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">acotd</span><span class="p">):</span>
                <span class="c1"># evaluate the function</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">math</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">atan</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">pop</span><span class="p">()))</span> <span class="p">)</span>

            <span class="k">elif</span> <span class="p">(</span><span class="n">item</span> <span class="o">==</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">sqrt</span><span class="p">):</span>
                <span class="c1"># evaluate the function</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">pop</span><span class="p">())</span> <span class="p">)</span>

            <span class="k">elif</span> <span class="p">(</span><span class="n">item</span> <span class="o">==</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">abs</span><span class="p">):</span>
                <span class="c1"># evaluate the function</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">math</span><span class="o">.</span><span class="n">fabs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">pop</span><span class="p">())</span> <span class="p">)</span>

            <span class="k">elif</span> <span class="p">(</span><span class="n">item</span> <span class="o">==</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">log</span><span class="p">):</span>
                <span class="c1"># evaluate the function</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">pop</span><span class="p">())</span> <span class="p">)</span>

            <span class="k">elif</span> <span class="p">(</span><span class="n">item</span> <span class="o">==</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">log10</span><span class="p">):</span>
                <span class="c1"># evaluate the function</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">pop</span><span class="p">())</span> <span class="p">)</span>

            <span class="k">elif</span> <span class="p">(</span><span class="n">item</span> <span class="o">==</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">log2</span><span class="p">):</span>
                <span class="c1"># evaluate the function</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">math</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">pop</span><span class="p">())</span> <span class="p">)</span>

            <span class="c1"># order-dependent binary functions require that the operand order be opposite from that of the stack pop operation</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">item</span> <span class="o">==</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">atan2</span><span class="p">):</span>
                <span class="n">op2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                <span class="n">op1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                <span class="c1"># apply the operator</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">math</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="n">op1</span><span class="p">,</span> <span class="n">op2</span><span class="p">)</span> <span class="p">)</span>

            <span class="k">elif</span> <span class="p">(</span><span class="n">item</span> <span class="o">==</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">atan2d</span><span class="p">):</span>
                <span class="n">op2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                <span class="n">op1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                <span class="c1"># apply the operator</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">math</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="n">op1</span><span class="p">,</span> <span class="n">op2</span><span class="p">))</span> <span class="p">)</span>

            <span class="c1"># (binary) operators require that two values are popped and the result is added back to the stack</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">item</span> <span class="o">==</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">add</span><span class="p">):</span>
                <span class="c1"># apply the operator</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">pop</span><span class="p">())</span>

            <span class="k">elif</span> <span class="p">(</span><span class="n">item</span> <span class="o">==</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">multiply</span><span class="p">):</span>
                <span class="c1"># apply the operator</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">pop</span><span class="p">())</span>

            <span class="c1"># order-dependent operators (-  /  ^  &lt;  &lt;=  &gt;  &gt;=) require that the operand order be opposite from that of the stack pop operation</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">item</span> <span class="o">==</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">subtract</span><span class="p">):</span>
                <span class="n">op2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                <span class="n">op1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                <span class="c1"># apply the operator</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">op1</span> <span class="o">-</span> <span class="n">op2</span><span class="p">)</span>

            <span class="k">elif</span> <span class="p">(</span><span class="n">item</span> <span class="o">==</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">negate</span><span class="p">):</span>
                <span class="c1"># return the same value but with the sign reversed</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span> <span class="p">)</span>

            <span class="k">elif</span> <span class="p">(</span><span class="n">item</span> <span class="o">==</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">divide</span><span class="p">):</span>
                <span class="n">op2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                <span class="n">op1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                <span class="c1"># apply the operator</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">op1</span> <span class="o">/</span> <span class="n">op2</span><span class="p">)</span>

            <span class="k">elif</span> <span class="p">(</span><span class="n">item</span> <span class="o">==</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">power</span><span class="p">):</span>
                <span class="n">op2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                <span class="n">op1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                <span class="c1"># apply the operator</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">op1</span> <span class="o">**</span> <span class="n">op2</span><span class="p">)</span>

            <span class="k">elif</span> <span class="p">(</span><span class="n">item</span> <span class="o">==</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">eq</span><span class="p">):</span>
                <span class="n">op2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                <span class="n">op1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                <span class="c1"># apply the operator</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">op1</span> <span class="o">==</span> <span class="n">op2</span><span class="p">))</span>

            <span class="k">elif</span> <span class="p">(</span><span class="n">item</span> <span class="o">==</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">ne</span><span class="p">):</span>
                <span class="n">op2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                <span class="n">op1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                <span class="c1"># apply the operator</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">op1</span> <span class="o">!=</span> <span class="n">op2</span><span class="p">))</span>

            <span class="k">elif</span> <span class="p">(</span><span class="n">item</span> <span class="o">==</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">lt</span><span class="p">):</span>
                <span class="n">op2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                <span class="n">op1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                <span class="c1"># apply the operator</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">op1</span> <span class="o">&lt;</span> <span class="n">op2</span><span class="p">))</span>

            <span class="k">elif</span> <span class="p">(</span><span class="n">item</span> <span class="o">==</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">le</span><span class="p">):</span>
                <span class="n">op2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                <span class="n">op1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                <span class="c1"># apply the operator</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">op1</span> <span class="o">&lt;=</span> <span class="n">op2</span><span class="p">))</span>

            <span class="k">elif</span> <span class="p">(</span><span class="n">item</span> <span class="o">==</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">gt</span><span class="p">):</span>
                <span class="n">op2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                <span class="n">op1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                <span class="c1"># apply the operator</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">op1</span> <span class="o">&gt;</span> <span class="n">op2</span><span class="p">))</span>

            <span class="k">elif</span> <span class="p">(</span><span class="n">item</span> <span class="o">==</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">ge</span><span class="p">):</span>
                <span class="n">op2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                <span class="n">op1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                <span class="c1"># apply the operator</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">op1</span> <span class="o">&gt;=</span> <span class="n">op2</span><span class="p">))</span>

            <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;postfixStack = </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;evaluation error / wrong number of operands or operators&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">postfixStack</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></div></div>
    <span class="c1"># end evaluate()</span>

<span class="c1"># end class ProductionFunction</span>

<div class="viewcode-block" id="DistributionFunction"><a class="viewcode-back" href="../../generated/pep.pep.DistributionFunction.html#pep.pep.DistributionFunction">[docs]</a><span class="k">class</span> <span class="nc">DistributionFunction</span><span class="p">(</span><span class="nb">list</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Distribution function class (list of distribution rules)</span>

<span class="sd">    :ivar int proportionTotal: the sum of all proportions</span>
<span class="sd">    :ivar str expression: string representation of the distribution function</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="DistributionFunction.__init__"><a class="viewcode-back" href="../../generated/pep.pep.DistributionFunction.html#pep.pep.DistributionFunction.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize the underling list used to store rules&quot;&quot;&quot;</span>
        <span class="nb">list</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">proportionTotal</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">expression</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span></div>

<div class="viewcode-block" id="DistributionFunction.distribute"><a class="viewcode-back" href="../../generated/pep.pep.DistributionFunction.html#pep.pep.DistributionFunction.distribute">[docs]</a>    <span class="k">def</span> <span class="nf">distribute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">newValue</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the variables referenced in the distribution rules according to the specified proportions</span>
<span class="sd">        :newValue: a value that has to be distributed to the variables based on the proportions specified in the distribution rules&quot;&quot;&quot;</span>

        <span class="k">for</span> <span class="n">distribRule</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">distribRule</span><span class="o">.</span><span class="n">variable</span><span class="o">.</span><span class="n">value</span> <span class="o">+=</span> <span class="p">(</span><span class="n">distribRule</span><span class="o">.</span><span class="n">proportion</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">proportionTotal</span><span class="p">)</span> <span class="o">*</span> <span class="n">newValue</span></div></div>
    <span class="c1"># end distribute()</span>
<span class="c1"># end class DistributionFunction</span>

<div class="viewcode-block" id="DistributionRule"><a class="viewcode-back" href="../../generated/pep.pep.DistributionRule.html#pep.pep.DistributionRule">[docs]</a><span class="k">class</span> <span class="nc">DistributionRule</span><span class="p">():</span>

    <span class="sd">&quot;&quot;&quot;Class for the distribution rules that make up a program, together with the production rules</span>

<span class="sd">    :ivar int proportion:</span>
<span class="sd">    :ivar Pobject variable:</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="DistributionRule.__init__"><a class="viewcode-back" href="../../generated/pep.pep.DistributionRule.html#pep.pep.DistributionRule.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">proportion</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">variable</span> <span class="o">=</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="DistributionRule.print"><a class="viewcode-back" href="../../generated/pep.pep.DistributionRule.html#pep.pep.DistributionRule.print">[docs]</a>    <span class="k">def</span> <span class="nf">print</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indentSpaces</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">toString</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Print a distribution rule with a given indentation level</span>

<span class="sd">        :indentSpaces: number of spaces used for indentation</span>
<span class="sd">        :toString: write to a string instead of stdout</span>
<span class="sd">        :returns: string print of the rule if toString = True otherwise returns None &quot;&quot;&quot;</span>

        <span class="c1"># PROPORTION | VAR_NAME</span>
        <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="n">indentSpaces</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">%d</span><span class="s2">|</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">proportion</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">toString</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">result</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div></div>
    <span class="c1"># end print()</span>
<span class="c1"># end class DistributionRule</span>

<div class="viewcode-block" id="Pobject"><a class="viewcode-back" href="../../generated/pep.pep.Pobject.html#pep.pep.Pobject">[docs]</a><span class="k">class</span> <span class="nc">Pobject</span><span class="p">():</span>

    <span class="sd">&quot;&quot;&quot;Mutable objects that are needed in order to allow all membranes that use the P object to globally modify the object</span>

<span class="sd">    :ivar str name:</span>
<span class="sd">    :ivar double value:</span>
<span class="sd">    :ivar boolean wasConsumed: was consumed in production function</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="Pobject.__init__"><a class="viewcode-back" href="../../generated/pep.pep.Pobject.html#pep.pep.Pobject.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wasConsumed</span> <span class="o">=</span> <span class="kc">False</span></div></div>
<span class="c1"># end class Pobject</span>


<span class="c1">##########################################################################</span>
<span class="c1"># global variables</span>

<span class="n">logLevel</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">INFO</span>

<span class="c1">##########################################################################</span>
<span class="c1"># auxiliary functions</span>

<div class="viewcode-block" id="processPostfixOperator"><a class="viewcode-back" href="../../generated/pep.pep.html#pep.pep.processPostfixOperator">[docs]</a><span class="k">def</span> <span class="nf">processPostfixOperator</span><span class="p">(</span><span class="n">postfixStack</span><span class="p">,</span> <span class="n">operator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Compares the provided operator with a postfix stack to determine where to place a new operator (output list or stack)</span>

<span class="sd">    :postfixStack: stack used for operators</span>
<span class="sd">    :operator: OperatorType variable</span>
<span class="sd">    :returns: postfixStack, outputList - outputList == array of OperatorType elements that have been popped from the stack&quot;&quot;&quot;</span>

    <span class="n">outputList</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># if the operator has a higher precedence than the symbol at the top of the stack,</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">postfixStack</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">operator</span> <span class="o">&gt;</span> <span class="n">postfixStack</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
        <span class="c1"># operator is pushed onto the stack</span>
        <span class="n">postfixStack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">operator</span><span class="p">)</span>
    <span class="c1"># If the precedence of the symbol being scanned is lower than or equal to the precedence of the symbol at the top of the stack,</span>
    <span class="k">elif</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">postfixStack</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">operator</span> <span class="o">&lt;=</span> <span class="n">postfixStack</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
        <span class="c1"># one element of the stack is popped to the output;</span>
        <span class="n">outputList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">pop</span><span class="p">())</span>
        <span class="c1"># the scan pointer is not advanced. Instead, the symbol being scanned will be compared with the new top element on the stack.</span>
        <span class="n">newPostfixStack</span><span class="p">,</span> <span class="n">newOutputList</span> <span class="o">=</span> <span class="n">processPostfixOperator</span><span class="p">(</span><span class="n">postfixStack</span><span class="p">,</span> <span class="n">operator</span><span class="p">)</span>

        <span class="n">postfixStack</span> <span class="o">=</span> <span class="n">newPostfixStack</span>
        <span class="n">outputList</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">newOutputList</span><span class="p">)</span>
    <span class="c1"># if the stack is empty</span>
    <span class="k">elif</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">postfixStack</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
        <span class="n">postfixStack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">operator</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">postfixStack</span><span class="p">,</span> <span class="n">outputList</span></div>
<span class="c1"># end processPostfixOperator()</span>

<div class="viewcode-block" id="tokenize"><a class="viewcode-back" href="../../generated/pep.pep.html#pep.pep.tokenize">[docs]</a><span class="k">def</span> <span class="nf">tokenize</span><span class="p">(</span><span class="n">code</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; generate a token list of input text</span>
<span class="sd">        adapted from https://docs.python.org/3/library/re.html#writing-a-tokenizer&quot;&quot;&quot;</span>

    <span class="c1"># ORDER MATTERS here: more complex tokens (e.g. &gt;= are checked before &gt;) to avoid incorect parsing</span>
    <span class="n">token_specification</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="s1">&#39;FUNCTION_ASIND&#39;</span><span class="p">,</span>  <span class="sa">r</span><span class="s1">&#39;asind&#39;</span><span class="p">),</span>     <span class="c1"># trigonometric function &#39;asin (x)&#39; with output in degrees</span>
        <span class="p">(</span><span class="s1">&#39;FUNCTION_ASIN&#39;</span><span class="p">,</span>   <span class="sa">r</span><span class="s1">&#39;asin&#39;</span><span class="p">),</span>      <span class="c1"># trigonometric function &#39;asin (x)&#39; with output in radians</span>
        <span class="p">(</span><span class="s1">&#39;FUNCTION_SIND&#39;</span><span class="p">,</span>   <span class="sa">r</span><span class="s1">&#39;sind&#39;</span><span class="p">),</span>      <span class="c1"># trigonometric function &#39;sin (x)&#39; with input in degrees</span>
        <span class="p">(</span><span class="s1">&#39;FUNCTION_SIN&#39;</span><span class="p">,</span>    <span class="sa">r</span><span class="s1">&#39;sin&#39;</span><span class="p">),</span>       <span class="c1"># trigonometric function &#39;sin (x)&#39; with input in radians</span>
        <span class="p">(</span><span class="s1">&#39;FUNCTION_ACOSD&#39;</span><span class="p">,</span>  <span class="sa">r</span><span class="s1">&#39;acosd&#39;</span><span class="p">),</span>     <span class="c1"># trigonometric function &#39;acos (x)&#39; with output in degrees</span>
        <span class="p">(</span><span class="s1">&#39;FUNCTION_ACOS&#39;</span><span class="p">,</span>   <span class="sa">r</span><span class="s1">&#39;acos&#39;</span><span class="p">),</span>      <span class="c1"># trigonometric function &#39;acos (x)&#39; with output in radians</span>
        <span class="p">(</span><span class="s1">&#39;FUNCTION_COSD&#39;</span><span class="p">,</span>   <span class="sa">r</span><span class="s1">&#39;cosd&#39;</span><span class="p">),</span>      <span class="c1"># trigonometric function &#39;cos (x)&#39; with input in degrees</span>
        <span class="p">(</span><span class="s1">&#39;FUNCTION_COS&#39;</span><span class="p">,</span>    <span class="sa">r</span><span class="s1">&#39;cos&#39;</span><span class="p">),</span>       <span class="c1"># trigonometric function &#39;cos (x)&#39; with input in radians</span>
        <span class="p">(</span><span class="s1">&#39;FUNCTION_ATAN2D&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;atan2d&#39;</span><span class="p">),</span>    <span class="c1"># trigonometric function &#39;atan2 (y, x)&#39; with output in degrees</span>
        <span class="p">(</span><span class="s1">&#39;FUNCTION_ATAN2&#39;</span><span class="p">,</span>  <span class="sa">r</span><span class="s1">&#39;atan2&#39;</span><span class="p">),</span>     <span class="c1"># trigonometric function &#39;atan2 (y, x)&#39; with output in radians</span>
        <span class="p">(</span><span class="s1">&#39;FUNCTION_ATAND&#39;</span><span class="p">,</span>  <span class="sa">r</span><span class="s1">&#39;atand&#39;</span><span class="p">),</span>     <span class="c1"># trigonometric function &#39;atan (x)&#39; with output in degrees</span>
        <span class="p">(</span><span class="s1">&#39;FUNCTION_ATAN&#39;</span><span class="p">,</span>   <span class="sa">r</span><span class="s1">&#39;atan&#39;</span><span class="p">),</span>      <span class="c1"># trigonometric function &#39;atan (x)&#39; with output in radians</span>
        <span class="p">(</span><span class="s1">&#39;FUNCTION_TAND&#39;</span><span class="p">,</span>   <span class="sa">r</span><span class="s1">&#39;tand&#39;</span><span class="p">),</span>      <span class="c1"># trigonometric function &#39;tan (x)&#39; with input in degrees</span>
        <span class="p">(</span><span class="s1">&#39;FUNCTION_TAN&#39;</span><span class="p">,</span>    <span class="sa">r</span><span class="s1">&#39;tan&#39;</span><span class="p">),</span>       <span class="c1"># trigonometric function &#39;tan (x)&#39; with input in radians</span>
        <span class="p">(</span><span class="s1">&#39;FUNCTION_ACOTD&#39;</span><span class="p">,</span>  <span class="sa">r</span><span class="s1">&#39;acotd&#39;</span><span class="p">),</span>     <span class="c1"># trigonometric function &#39;acot (x)&#39; with output in degrees</span>
        <span class="p">(</span><span class="s1">&#39;FUNCTION_ACOT&#39;</span><span class="p">,</span>   <span class="sa">r</span><span class="s1">&#39;acot&#39;</span><span class="p">),</span>      <span class="c1"># trigonometric function &#39;acot (x)&#39; with output in radians</span>
        <span class="p">(</span><span class="s1">&#39;FUNCTION_COTD&#39;</span><span class="p">,</span>   <span class="sa">r</span><span class="s1">&#39;cotd&#39;</span><span class="p">),</span>      <span class="c1"># trigonometric function &#39;cot (x)&#39; with input in degrees</span>
        <span class="p">(</span><span class="s1">&#39;FUNCTION_COT&#39;</span><span class="p">,</span>    <span class="sa">r</span><span class="s1">&#39;cot&#39;</span><span class="p">),</span>       <span class="c1"># trigonometric function &#39;cot (x)&#39; with input in radians</span>

        <span class="p">(</span><span class="s1">&#39;FUNCTION_SQRT&#39;</span><span class="p">,</span>   <span class="sa">r</span><span class="s1">&#39;sqrt&#39;</span><span class="p">),</span>      <span class="c1"># square root function</span>
        <span class="p">(</span><span class="s1">&#39;FUNCTION_ABS&#39;</span><span class="p">,</span>    <span class="sa">r</span><span class="s1">&#39;abs&#39;</span><span class="p">),</span>       <span class="c1"># absolute value (modulus) function</span>
        <span class="p">(</span><span class="s1">&#39;FUNCTION_LOG10&#39;</span><span class="p">,</span>  <span class="sa">r</span><span class="s1">&#39;log10&#39;</span><span class="p">),</span>     <span class="c1"># base 10 logarithm function</span>
        <span class="p">(</span><span class="s1">&#39;FUNCTION_LOG2&#39;</span><span class="p">,</span>   <span class="sa">r</span><span class="s1">&#39;log2&#39;</span><span class="p">),</span>      <span class="c1"># base 2 logarithm function</span>
        <span class="p">(</span><span class="s1">&#39;FUNCTION_LOG&#39;</span><span class="p">,</span>    <span class="sa">r</span><span class="s1">&#39;log&#39;</span><span class="p">),</span>       <span class="c1"># base e (natural) logarithm function</span>

        <span class="p">(</span><span class="s1">&#39;NUMBER_FLOAT&#39;</span><span class="p">,</span>  <span class="sa">r</span><span class="s1">&#39;\d+\.\d+&#39;</span><span class="p">),</span>    <span class="c1"># Float number</span>
        <span class="p">(</span><span class="s1">&#39;NUMBER&#39;</span><span class="p">,</span>        <span class="sa">r</span><span class="s1">&#39;\d+&#39;</span><span class="p">),</span>         <span class="c1"># Integer number</span>

        <span class="p">(</span><span class="s1">&#39;OPERATOR_NOT_EQUAL&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;\!\=&#39;</span><span class="p">),</span>   <span class="c1"># Not equal operator (!=)</span>
        <span class="p">(</span><span class="s1">&#39;OPERATOR_EQUAL&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;\=\=&#39;</span><span class="p">),</span>       <span class="c1"># Equal operator (==)</span>
        <span class="p">(</span><span class="s1">&#39;OPERATOR_LESS_EQUAL&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;\&lt;\=&#39;</span><span class="p">),</span>  <span class="c1"># Less or equal operator (&lt;=)</span>
        <span class="p">(</span><span class="s1">&#39;OPERATOR_GREATER_EQUAL&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;\&gt;\=&#39;</span><span class="p">),</span><span class="c1"># Greater or equal operator (&gt;=)</span>

        <span class="p">(</span><span class="s1">&#39;ASSIGN&#39;</span><span class="p">,</span>        <span class="sa">r</span><span class="s1">&#39;=&#39;</span><span class="p">),</span>           <span class="c1"># Assignment operator &#39;=&#39;</span>
        <span class="p">(</span><span class="s1">&#39;END&#39;</span><span class="p">,</span>           <span class="sa">r</span><span class="s1">&#39;;&#39;</span><span class="p">),</span>           <span class="c1"># Statement terminator &#39;;&#39;</span>
        <span class="p">(</span><span class="s1">&#39;ID&#39;</span><span class="p">,</span>            <span class="sa">r</span><span class="s1">&#39;[\w]+&#39;</span><span class="p">),</span>       <span class="c1"># Identifiers</span>
        <span class="p">(</span><span class="s1">&#39;L_BRACE&#39;</span><span class="p">,</span>       <span class="sa">r</span><span class="s1">&#39;\(&#39;</span><span class="p">),</span>          <span class="c1"># Left brace &#39;(&#39;</span>
        <span class="p">(</span><span class="s1">&#39;R_BRACE&#39;</span><span class="p">,</span>       <span class="sa">r</span><span class="s1">&#39;\)&#39;</span><span class="p">),</span>          <span class="c1"># Right brace &#39;)&#39;</span>
        <span class="p">(</span><span class="s1">&#39;L_CURLY_BRACE&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;{&#39;</span><span class="p">),</span>           <span class="c1"># Left curly brace &#39;{&#39;</span>
        <span class="p">(</span><span class="s1">&#39;R_CURLY_BRACE&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;}&#39;</span><span class="p">),</span>           <span class="c1"># Right curly brace &#39;}&#39;</span>
        <span class="p">(</span><span class="s1">&#39;L_BRACKET&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;\[&#39;</span><span class="p">),</span>              <span class="c1"># Left bracket (straight brace) &#39;[&#39;</span>
        <span class="p">(</span><span class="s1">&#39;R_BRACKET&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;\]&#39;</span><span class="p">),</span>              <span class="c1"># Right bracket (straight brace) &#39;]&#39;</span>
        <span class="p">(</span><span class="s1">&#39;COLUMN&#39;</span><span class="p">,</span>        <span class="sa">r</span><span class="s1">&#39;,&#39;</span><span class="p">),</span>           <span class="c1"># column &#39;,&#39;</span>

        <span class="p">(</span><span class="s1">&#39;PROD_DISTRIB_SEPARATOR&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;-&gt;&#39;</span><span class="p">),</span> <span class="c1"># Program production and distribution component separator sign &#39;-&gt;&#39;</span>
        <span class="p">(</span><span class="s1">&#39;OPERATOR_ADD&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;\+&#39;</span><span class="p">),</span>          <span class="c1"># Addition operator (+)</span>
        <span class="p">(</span><span class="s1">&#39;OPERATOR_SUBTRACT&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;\-&#39;</span><span class="p">),</span>         <span class="c1"># Subtraction operator (-)</span>
        <span class="p">(</span><span class="s1">&#39;OPERATOR_NEGATE&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;\~&#39;</span><span class="p">),</span>         <span class="c1"># Subtraction operator (-)</span>
        <span class="p">(</span><span class="s1">&#39;OPERATOR_MULTIPLY&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;\*&#39;</span><span class="p">),</span>      <span class="c1"># Multiplication operator (*)</span>
        <span class="p">(</span><span class="s1">&#39;OPERATOR_DIVIDE&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;\/&#39;</span><span class="p">),</span>        <span class="c1"># Division operator (/)</span>
        <span class="p">(</span><span class="s1">&#39;OPERATOR_POWER&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;\^&#39;</span><span class="p">),</span>         <span class="c1"># Power operator (^)</span>

        <span class="p">(</span><span class="s1">&#39;OPERATOR_LESS_THAN&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;\&lt;&#39;</span><span class="p">),</span>     <span class="c1"># Less than operator (&lt;)</span>
        <span class="p">(</span><span class="s1">&#39;OPERATOR_GREATER_THAN&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;\&gt;&#39;</span><span class="p">),</span>  <span class="c1"># Greater than operator (&gt;)</span>
        <span class="p">(</span><span class="s1">&#39;DISTRIBUTION_SIGN&#39;</span><span class="p">,</span>    <span class="sa">r</span><span class="s1">&#39;\|&#39;</span><span class="p">),</span>   <span class="c1"># Distribution rule sign &#39;|&#39;</span>

        <span class="p">(</span><span class="s1">&#39;NEWLINE&#39;</span><span class="p">,</span>       <span class="sa">r</span><span class="s1">&#39;\n&#39;</span><span class="p">),</span>          <span class="c1"># Line endings</span>
        <span class="p">(</span><span class="s1">&#39;COMMENT&#39;</span><span class="p">,</span>       <span class="sa">r</span><span class="s1">&#39;#&#39;</span><span class="p">),</span>           <span class="c1"># Comment (anything after #, up to the end of the line is discarded)</span>
        <span class="p">(</span><span class="s1">&#39;SKIP&#39;</span><span class="p">,</span>          <span class="sa">r</span><span class="s1">&#39;[ \t]+&#39;</span><span class="p">),</span>      <span class="c1"># Skip over spaces and tabs</span>
        <span class="p">(</span><span class="s1">&#39;MISMATCH&#39;</span><span class="p">,</span>      <span class="sa">r</span><span class="s1">&#39;.&#39;</span><span class="p">),</span>           <span class="c1"># Any other character</span>
    <span class="p">]</span>
    <span class="c1"># join all groups into one regex expr; ex:?P&lt;NUMBER&gt;\d+(\.\d*)?) | ...</span>
    <span class="n">tok_regex</span> <span class="o">=</span> <span class="s1">&#39;|&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;(?P&lt;</span><span class="si">%s</span><span class="s1">&gt;</span><span class="si">%s</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="n">pair</span> <span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="n">token_specification</span><span class="p">)</span>
    <span class="n">line_num</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">line_start</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">in_comment</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="c1"># iteratively search and return each match (for any of the groups)</span>
    <span class="k">for</span> <span class="n">mo</span> <span class="ow">in</span> <span class="n">re</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="n">tok_regex</span><span class="p">,</span> <span class="n">code</span><span class="p">):</span>
        <span class="n">kind</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">lastgroup</span> <span class="c1"># last group name matched</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="n">kind</span><span class="p">)</span> <span class="c1"># the last matched string (for group kind)</span>
        <span class="c1">#print(&quot;kind = %s, value = %s&quot; % (kind, value))</span>
        <span class="k">if</span> <span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;COMMENT&#39;</span><span class="p">:</span>
            <span class="n">in_comment</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;NEWLINE&#39;</span><span class="p">:</span>
            <span class="n">line_start</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">end</span><span class="p">()</span>
            <span class="n">line_num</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">in_comment</span> <span class="o">=</span> <span class="kc">False</span> <span class="c1"># reset in_comment state</span>
        <span class="k">elif</span> <span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;SKIP&#39;</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;MISMATCH&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">in_comment</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%r</span><span class="s1"> unexpected on line </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">line_num</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># skip normal tokens if in comment (cleared at the end of the line)</span>
            <span class="k">if</span> <span class="n">in_comment</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">column</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">start</span><span class="p">()</span> <span class="o">-</span> <span class="n">line_start</span>
            <span class="k">yield</span> <span class="n">Token</span><span class="p">(</span><span class="n">kind</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">line_num</span><span class="p">,</span> <span class="n">column</span><span class="p">)</span></div>
<span class="c1">#end tokenize()</span>

<div class="viewcode-block" id="print_token_by_line"><a class="viewcode-back" href="../../generated/pep.pep.html#pep.pep.print_token_by_line">[docs]</a><span class="k">def</span> <span class="nf">print_token_by_line</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Prints tokens separated by spaces on their original line (with line numbering)&quot;&quot;&quot;</span>
    <span class="n">line_num</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">v</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">line</span> <span class="o">&gt;</span> <span class="n">line_num</span><span class="p">):</span>
            <span class="n">line_num</span> <span class="o">=</span> <span class="n">token</span><span class="o">.</span><span class="n">line</span><span class="p">;</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="si">%d</span><span class="s1">  &#39;</span> <span class="o">%</span> <span class="n">line_num</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">);</span>

        <span class="nb">print</span><span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">);</span></div>
<span class="c1"># end print_token_by_line()</span>

<div class="viewcode-block" id="process_tokens"><a class="viewcode-back" href="../../generated/pep.pep.html#pep.pep.process_tokens">[docs]</a><span class="k">def</span> <span class="nf">process_tokens</span><span class="p">(</span><span class="n">tokens</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Process tokens recurently and return a P system structure (or a subcomponent of the same type as parent)</span>

<span class="sd">    :tokens: the list of tokens to be processed</span>
<span class="sd">    :parent: an object that represents the type of the result</span>
<span class="sd">    :index: the start index in the list of tokens</span>
<span class="sd">    :returns: index - the current index in the token list (after finishing this component)</span>
<span class="sd">    :returns: result - an object that is the result of processing the input parent and tokens &quot;&quot;&quot;</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;process_tokens (parent_type = </span><span class="si">%s</span><span class="s2">, index = </span><span class="si">%d</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">parent</span><span class="p">),</span> <span class="n">index</span><span class="p">))</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">parent</span> <span class="c1"># construct the result of specified type</span>
    <span class="n">prev_token</span> <span class="o">=</span> <span class="n">tokens</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
    <span class="c1"># for processing distribution rules</span>
    <span class="n">distribRule</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">while</span> <span class="p">(</span><span class="n">index</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">tokens</span><span class="p">)):</span>
        <span class="n">token</span> <span class="o">=</span> <span class="n">tokens</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;token = &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span> <span class="o">%</span> <span class="n">token</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span> <span class="o">==</span> <span class="n">NumericalPsystem</span><span class="p">):</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;processing as NumericalPsystem&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;ASSIGN&#39;</span><span class="p">):</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">prev_token</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="s1">&#39;H&#39;</span><span class="p">):</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;building membrane list&quot;</span><span class="p">);</span>
                    <span class="n">index</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">H</span> <span class="o">=</span> <span class="n">process_tokens</span><span class="p">(</span><span class="n">tokens</span><span class="p">,</span> <span class="nb">list</span><span class="p">(),</span> <span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>

                <span class="c1"># if the prev_token is the name of a membrane</span>
                <span class="k">elif</span> <span class="p">(</span><span class="n">prev_token</span><span class="o">.</span><span class="n">value</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">H</span><span class="p">):</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;building Membrane&quot;</span><span class="p">);</span>
                    <span class="n">index</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">membranes</span><span class="p">[</span><span class="n">prev_token</span><span class="o">.</span><span class="n">value</span><span class="p">]</span> <span class="o">=</span> <span class="n">process_tokens</span><span class="p">(</span><span class="n">tokens</span><span class="p">,</span> <span class="n">Membrane</span><span class="p">(),</span> <span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>

                <span class="k">elif</span> <span class="p">(</span><span class="n">prev_token</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="s1">&#39;structure&#39;</span><span class="p">):</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;building membrane structure&quot;</span><span class="p">);</span>
                    <span class="n">index</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">structure</span> <span class="o">=</span> <span class="n">process_tokens</span><span class="p">(</span><span class="n">tokens</span><span class="p">,</span> <span class="n">MembraneStructure</span><span class="p">(),</span> <span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Unexpected token &#39;</span><span class="si">%s</span><span class="s2">&#39; on line </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prev_token</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">prev_token</span><span class="o">.</span><span class="n">line</span><span class="p">))</span>
        <span class="c1"># end if parent == NumericalPsystem</span>

        <span class="k">elif</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span> <span class="o">==</span> <span class="n">MembraneStructure</span><span class="p">):</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;processing as MembraneStructure&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;ID&#39;</span><span class="p">,</span> <span class="s1">&#39;NUMBER&#39;</span><span class="p">,</span> <span class="s1">&#39;L_BRACKET&#39;</span><span class="p">,</span> <span class="s1">&#39;R_BRACKET&#39;</span><span class="p">)):</span>
                <span class="n">parent</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>

            <span class="k">elif</span> <span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;END&#39;</span><span class="p">):</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;finished the MembraneStructure with result = </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">result</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">index</span><span class="p">,</span> <span class="n">result</span><span class="p">;</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Unexpected token &#39;</span><span class="si">%s</span><span class="s2">&#39; on line </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">token</span><span class="o">.</span><span class="n">line</span><span class="p">))</span>
        <span class="c1"># end if parent == MembraneStructure</span>

        <span class="k">elif</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span> <span class="o">==</span> <span class="n">Membrane</span><span class="p">):</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;processing as Membrane&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;ASSIGN&#39;</span><span class="p">):</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">prev_token</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="s1">&#39;var&#39;</span><span class="p">):</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;building variable list&quot;</span><span class="p">);</span>
                    <span class="n">index</span><span class="p">,</span> <span class="n">variables</span> <span class="o">=</span> <span class="n">process_tokens</span><span class="p">(</span><span class="n">tokens</span><span class="p">,</span> <span class="nb">list</span><span class="p">(),</span> <span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
                    <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">variables</span><span class="p">:</span>
                        <span class="n">result</span><span class="o">.</span><span class="n">variables</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Pobject</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="n">var</span><span class="p">))</span>

                <span class="k">elif</span> <span class="p">(</span><span class="n">prev_token</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="s1">&#39;E&#39;</span><span class="p">):</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;building enzyme list&quot;</span><span class="p">);</span>
                    <span class="n">index</span><span class="p">,</span> <span class="n">enzymes</span> <span class="o">=</span> <span class="n">process_tokens</span><span class="p">(</span><span class="n">tokens</span><span class="p">,</span> <span class="nb">list</span><span class="p">(),</span> <span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
                    <span class="k">for</span> <span class="n">enz</span> <span class="ow">in</span> <span class="n">enzymes</span><span class="p">:</span>
                        <span class="n">result</span><span class="o">.</span><span class="n">enzymes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Pobject</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="n">enz</span><span class="p">))</span>

                <span class="k">elif</span> <span class="p">(</span><span class="n">prev_token</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="s1">&#39;pr&#39;</span><span class="p">):</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;building Program&quot;</span><span class="p">);</span>
                    <span class="n">index</span><span class="p">,</span> <span class="n">program</span> <span class="o">=</span> <span class="n">process_tokens</span><span class="p">(</span><span class="n">tokens</span><span class="p">,</span> <span class="n">Program</span><span class="p">(),</span> <span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">programs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">program</span><span class="p">)</span>

                <span class="k">elif</span> <span class="p">(</span><span class="n">prev_token</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="s1">&#39;var0&#39;</span><span class="p">):</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;building var0 list&quot;</span><span class="p">);</span>
                    <span class="n">index</span><span class="p">,</span> <span class="n">variables</span> <span class="o">=</span> <span class="n">process_tokens</span><span class="p">(</span><span class="n">tokens</span><span class="p">,</span> <span class="nb">list</span><span class="p">(),</span> <span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
                    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">var</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">variables</span><span class="p">):</span>
                        <span class="n">result</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">var</span>

                <span class="k">elif</span> <span class="p">(</span><span class="n">prev_token</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="s1">&#39;E0&#39;</span><span class="p">):</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;building E0 list&quot;</span><span class="p">);</span>
                    <span class="n">index</span><span class="p">,</span> <span class="n">enzymes</span> <span class="o">=</span> <span class="n">process_tokens</span><span class="p">(</span><span class="n">tokens</span><span class="p">,</span> <span class="nb">list</span><span class="p">(),</span> <span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
                    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">enz</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">enzymes</span><span class="p">):</span>
                        <span class="n">result</span><span class="o">.</span><span class="n">enzymes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">enz</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Unexpected token &#39;</span><span class="si">%s</span><span class="s2">&#39; on line </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">token</span><span class="o">.</span><span class="n">line</span><span class="p">))</span>
        <span class="c1"># end if parent == Membrane</span>

        <span class="k">elif</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span> <span class="o">==</span> <span class="n">Program</span><span class="p">):</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;processing as Program&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;L_CURLY_BRACE&#39;</span><span class="p">):</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;building production function&quot;</span><span class="p">);</span>
                <span class="n">index</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">prodFunction</span> <span class="o">=</span> <span class="n">process_tokens</span><span class="p">(</span><span class="n">tokens</span><span class="p">,</span> <span class="n">ProductionFunction</span><span class="p">(),</span> <span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>

            <span class="k">elif</span> <span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;L_BRACKET&#39;</span><span class="p">):</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;storing enzyme required by program&quot;</span><span class="p">);</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">tokens</span><span class="p">[</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;ID&#39;</span><span class="p">):</span>
                    <span class="c1"># storing enzyme as string for now, will be referenced later to a Pobject</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">enzyme</span> <span class="o">=</span> <span class="n">tokens</span><span class="p">[</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
                    <span class="n">index</span> <span class="o">+=</span> <span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Unexpected token &#39;</span><span class="si">%s</span><span class="s2">&#39; on line </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">token</span><span class="o">.</span><span class="n">line</span><span class="p">))</span>


            <span class="c1"># build a distribution rule if the PROD_DISTRIB_SEPARATOR &#39;|&#39; is reached for a non-enzymatic program or R_BRACKET &#39;]&#39; is reached for an enzymatic program</span>
            <span class="k">elif</span> <span class="p">((</span><span class="n">token</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;PROD_DISTRIB_SEPARATOR&#39;</span> <span class="ow">and</span> <span class="n">result</span><span class="o">.</span><span class="n">enzyme</span> <span class="o">==</span> <span class="kc">None</span><span class="p">)</span>
                    <span class="ow">or</span> <span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;R_BRACKET&#39;</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">enzyme</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">)):</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;building distribution rule&quot;</span><span class="p">);</span>
                <span class="n">index</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">distribFunction</span> <span class="o">=</span> <span class="n">process_tokens</span><span class="p">(</span><span class="n">tokens</span><span class="p">,</span> <span class="n">DistributionFunction</span><span class="p">(),</span> <span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>

            <span class="k">elif</span> <span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;R_CURLY_BRACE&#39;</span><span class="p">):</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;finished this Program with result = </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">result</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">index</span><span class="p">,</span> <span class="n">result</span><span class="p">;</span>

            <span class="k">elif</span> <span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;END&#39;</span><span class="p">):</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;finished this block with result = </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">result</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">index</span><span class="p">,</span> <span class="n">result</span><span class="p">;</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Unexpected token &#39;</span><span class="si">%s</span><span class="s2">&#39; on line </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">token</span><span class="o">.</span><span class="n">line</span><span class="p">))</span>
        <span class="c1"># end if parent == Program</span>

        <span class="k">elif</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span> <span class="o">==</span> <span class="n">ProductionFunction</span><span class="p">):</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;processing as ProductionFunction&quot;</span><span class="p">)</span>
            <span class="c1"># construct a string representation of the expression (in infix form)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">type</span> <span class="o">!=</span> <span class="s1">&#39;PROD_DISTRIB_SEPARATOR&#39;</span> <span class="ow">and</span> <span class="n">token</span><span class="o">.</span><span class="n">type</span> <span class="o">!=</span> <span class="s1">&#39;L_BRACKET&#39;</span><span class="p">):</span>
                <span class="n">result</span><span class="o">.</span><span class="n">infixExpression</span> <span class="o">+=</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">token</span><span class="o">.</span><span class="n">value</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;NUMBER&#39;</span><span class="p">):</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;processing integer number&quot;</span><span class="p">)</span>
                <span class="n">result</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>

            <span class="k">elif</span> <span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;NUMBER_FLOAT&#39;</span><span class="p">):</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;processing float number&quot;</span><span class="p">)</span>
                <span class="n">result</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>

            <span class="k">elif</span> <span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;ID&#39;</span><span class="p">):</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;processing variable&quot;</span><span class="p">)</span>
                <span class="n">result</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="c1"># store as string for now, reference to real P object later</span>

            <span class="k">elif</span> <span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;L_BRACE&#39;</span><span class="p">):</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;processing operator </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">token</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
                <span class="c1"># add the current operator to the postfix transformation</span>
                <span class="n">result</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">OperatorType</span><span class="o">.</span><span class="n">left_brace</span><span class="p">)</span>

            <span class="k">elif</span> <span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;R_BRACE&#39;</span><span class="p">):</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;processing operator </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">token</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
                <span class="c1"># pop all elements in the stack up until the left brace and add them to the postfix form</span>
                <span class="k">while</span> <span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">postfixStack</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">OperatorType</span><span class="o">.</span><span class="n">left_brace</span><span class="p">):</span>
                    <span class="n">op</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                    <span class="c1"># append all popped operators</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">op</span><span class="p">)</span>
                <span class="c1"># now that all elements that were above the left_brace were removed, we pop the left_brace (now the top-most element) from the stack</span>
                <span class="n">result</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>

            <span class="k">elif</span> <span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">type</span> <span class="ow">in</span> <span class="n">dictOperatorTypes</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;processing operator </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">token</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
                <span class="c1"># current operator as OperatorType enum value</span>
                <span class="n">currentOperator</span> <span class="o">=</span> <span class="n">dictOperatorTypes</span><span class="p">[</span><span class="n">token</span><span class="o">.</span><span class="n">type</span><span class="p">]</span>

                <span class="n">result</span><span class="o">.</span><span class="n">postfixStack</span><span class="p">,</span> <span class="n">newOutputList</span> <span class="o">=</span> <span class="n">processPostfixOperator</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">postfixStack</span><span class="p">,</span> <span class="n">currentOperator</span><span class="p">)</span>
                <span class="n">result</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">newOutputList</span><span class="p">)</span>

            <span class="k">elif</span> <span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;PROD_DISTRIB_SEPARATOR&#39;</span> <span class="ow">or</span> <span class="n">token</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;L_BRACKET&#39;</span><span class="p">):</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;production function end; emptying stack&quot;</span><span class="p">)</span>
                <span class="c1"># pop all elements in the stack</span>
                <span class="k">while</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">postfixStack</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">postfixStack</span><span class="o">.</span><span class="n">pop</span><span class="p">())</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;finished the production function with result = </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">result</span><span class="o">.</span><span class="n">items</span><span class="p">)</span>
                <span class="n">result</span><span class="o">.</span><span class="n">infixExpression</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">infixExpression</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="c1"># strip the first character (leading space)</span>
                <span class="c1"># the Program should also see PROD_DISTRIB_SEPARATOR or L_BRACKET in order to trigger the build of a distribution function or to store an enzyme for this program</span>
                <span class="k">return</span> <span class="n">index</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">result</span><span class="p">;</span>

            <span class="k">elif</span> <span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;L_CURLY_BRACE&#39;</span><span class="p">):</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;skipped left curly brace&quot;</span><span class="p">)</span>
                <span class="c1"># continue to next token</span>
                <span class="n">prev_token</span> <span class="o">=</span> <span class="n">token</span><span class="p">;</span>
                <span class="n">index</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">continue</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Unexpected token &#39;</span><span class="si">%s</span><span class="s2">&#39; on line </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">token</span><span class="o">.</span><span class="n">line</span><span class="p">))</span>
        <span class="c1"># end if parent == ProductionFunction</span>

        <span class="k">elif</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span> <span class="o">==</span> <span class="n">DistributionFunction</span><span class="p">):</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;processing as DistributionFunction&quot;</span><span class="p">)</span>


            <span class="k">if</span> <span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;NUMBER&#39;</span><span class="p">):</span>
                <span class="c1"># construct a new distribution rule</span>
                <span class="n">distribRule</span> <span class="o">=</span> <span class="n">DistributionRule</span><span class="p">()</span>
                <span class="n">distribRule</span><span class="o">.</span><span class="n">proportion</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
                <span class="n">result</span><span class="o">.</span><span class="n">expression</span> <span class="o">+=</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">token</span><span class="o">.</span><span class="n">value</span>

            <span class="k">elif</span> <span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;ID&#39;</span> <span class="ow">and</span> <span class="n">prev_token</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s2">&quot;DISTRIBUTION_SIGN&quot;</span><span class="p">):</span>
                <span class="c1"># finalize the distribution rule</span>
                <span class="n">distribRule</span><span class="o">.</span><span class="n">variable</span> <span class="o">=</span> <span class="n">token</span><span class="o">.</span><span class="n">value</span> <span class="c1"># store as string for now, reference later</span>
                <span class="n">result</span><span class="o">.</span><span class="n">proportionTotal</span> <span class="o">+=</span> <span class="n">distribRule</span><span class="o">.</span><span class="n">proportion</span>
                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">distribRule</span><span class="p">)</span> <span class="c1"># store the new distribution rule</span>
                <span class="n">result</span><span class="o">.</span><span class="n">expression</span> <span class="o">+=</span> <span class="n">token</span><span class="o">.</span><span class="n">value</span>

            <span class="c1"># is used to separate rules, not needed</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;OPERATOR_ADD&#39;</span><span class="p">):</span>
                <span class="n">result</span><span class="o">.</span><span class="n">expression</span> <span class="o">+=</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">token</span><span class="o">.</span><span class="n">value</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;skipped &#39;+&#39;&quot;</span><span class="p">)</span>
                <span class="c1"># continue to next token</span>
                <span class="n">prev_token</span> <span class="o">=</span> <span class="n">token</span><span class="p">;</span>
                <span class="n">index</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">continue</span>

            <span class="c1"># is used to separate the proportion from the variable, not needed</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s2">&quot;DISTRIBUTION_SIGN&quot;</span><span class="p">):</span>
                <span class="n">result</span><span class="o">.</span><span class="n">expression</span> <span class="o">+=</span> <span class="n">token</span><span class="o">.</span><span class="n">value</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;skipped &#39;|&#39;&quot;</span><span class="p">)</span>
                <span class="c1"># continue to next token</span>
                <span class="n">prev_token</span> <span class="o">=</span> <span class="n">token</span><span class="p">;</span>
                <span class="n">index</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">continue</span>

            <span class="k">elif</span> <span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;R_CURLY_BRACE&#39;</span><span class="p">):</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;finished this DistributionFunction with result = </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">result</span><span class="p">)</span>
                <span class="n">result</span><span class="o">.</span><span class="n">expression</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">expression</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="c1"># strip the first character (leading space)</span>
                <span class="k">return</span> <span class="n">index</span><span class="p">,</span> <span class="n">result</span><span class="p">;</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Unexpected token &#39;</span><span class="si">%s</span><span class="s2">&#39; on line </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">token</span><span class="o">.</span><span class="n">line</span><span class="p">))</span>
        <span class="c1"># end if parent == DistributionFunction</span>

        <span class="k">elif</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span> <span class="o">==</span> <span class="n">DistributionRule</span><span class="p">):</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;processing as DistributionRule&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;R_CURLY_BRACE&#39;</span><span class="p">):</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;finished this DistributionRule with result = </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">result</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">index</span><span class="p">,</span> <span class="n">result</span><span class="p">;</span>
        <span class="c1"># end if parent == DistributionRule</span>

        <span class="k">elif</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span> <span class="o">==</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;processing as List&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;ID&#39;</span><span class="p">):</span>
                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">value</span><span class="p">);</span>

            <span class="k">elif</span> <span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;NUMBER&#39;</span><span class="p">):</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">prev_token</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;OPERATOR_SUBTRACT&#39;</span><span class="p">):</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="o">-</span><span class="nb">int</span><span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">value</span><span class="p">));</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">value</span><span class="p">));</span>

            <span class="k">elif</span> <span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;NUMBER_FLOAT&#39;</span><span class="p">):</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">prev_token</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;OPERATOR_SUBTRACT&#39;</span><span class="p">):</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="o">-</span><span class="nb">float</span><span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">value</span><span class="p">));</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">value</span><span class="p">));</span>

        <span class="k">elif</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;processing as Str&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;ID&#39;</span><span class="p">):</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">token</span><span class="o">.</span><span class="n">value</span><span class="p">;</span>

        <span class="k">elif</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;processing as Int&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;NUMBER&#39;</span><span class="p">):</span>
                <span class="n">result</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">value</span><span class="p">);</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;processing as GENERAL&quot;</span><span class="p">)</span>
            <span class="c1"># process the token generally</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;ASSIGN&#39;</span><span class="p">):</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;building NumericalPsystem&quot;</span><span class="p">)</span>
                <span class="n">index</span><span class="p">,</span> <span class="n">result</span> <span class="o">=</span> <span class="n">process_tokens</span><span class="p">(</span><span class="n">tokens</span><span class="p">,</span> <span class="n">NumericalPsystem</span><span class="p">(),</span> <span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;END&#39;</span><span class="p">):</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;finished this block with result = </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">result</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">index</span><span class="p">,</span> <span class="n">result</span><span class="p">;</span>

        <span class="n">prev_token</span> <span class="o">=</span> <span class="n">token</span><span class="p">;</span>
        <span class="n">index</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">index</span><span class="p">,</span> <span class="n">result</span></div>
<span class="c1">#end process_tokens</span>
<div class="viewcode-block" id="readInputFile"><a class="viewcode-back" href="../../generated/pep.pep.html#pep.pep.readInputFile">[docs]</a><span class="k">def</span> <span class="nf">readInputFile</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">printTokens</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;parses the given input file and produces a P system object</span>

<span class="sd">    :filename: string path to the file that will be parsed</span>
<span class="sd">    :returns: P system object&quot;&quot;&quot;</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;reading input file&quot;</span><span class="p">)</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">file_in</span><span class="p">:</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">file_in</span><span class="o">.</span><span class="n">readlines</span><span class="p">());</span>

    <span class="c1"># construct array of tokens for later use</span>
    <span class="n">tokens</span> <span class="o">=</span> <span class="p">[</span><span class="n">token</span> <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">tokenize</span><span class="p">(</span><span class="n">lines</span><span class="p">)];</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">printTokens</span><span class="p">):</span>
        <span class="n">print_token_by_line</span><span class="p">(</span><span class="n">tokens</span><span class="p">);</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">);</span>

    <span class="n">index</span><span class="p">,</span> <span class="n">system</span> <span class="o">=</span> <span class="n">process_tokens</span><span class="p">(</span><span class="n">tokens</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;constructing a global list of variables used in the entire P system&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">membrane</span> <span class="ow">in</span> <span class="n">system</span><span class="o">.</span><span class="n">membranes</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">membrane</span><span class="o">.</span><span class="n">variables</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">var</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">system</span><span class="o">.</span><span class="n">variables</span><span class="p">:</span>
                <span class="n">system</span><span class="o">.</span><span class="n">variables</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>


    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;constructing a global list of enzymes used in the entire P system&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">membrane</span> <span class="ow">in</span> <span class="n">system</span><span class="o">.</span><span class="n">membranes</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">enz</span> <span class="ow">in</span> <span class="n">membrane</span><span class="o">.</span><span class="n">enzymes</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">enz</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">system</span><span class="o">.</span><span class="n">enzymes</span><span class="p">:</span>
                <span class="n">system</span><span class="o">.</span><span class="n">enzymes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">enz</span><span class="p">)</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;cross-referencing string identifiers of VARIABLES to the corresponding Pobject instance&quot;</span><span class="p">)</span>
    <span class="c1"># cross-reference string identifiers with references to Pobject instances</span>
    <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">system</span><span class="o">.</span><span class="n">variables</span><span class="p">:</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">membrane_name</span><span class="p">,</span> <span class="n">membrane</span><span class="p">)</span> <span class="ow">in</span> <span class="n">system</span><span class="o">.</span><span class="n">membranes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;processing membrane </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">membrane_name</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">pr</span> <span class="ow">in</span> <span class="n">membrane</span><span class="o">.</span><span class="n">programs</span><span class="p">:</span>
                <span class="c1"># replacing in production function</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">pr</span><span class="o">.</span><span class="n">prodFunction</span><span class="o">.</span><span class="n">items</span><span class="p">[:]):</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">var</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">item</span><span class="p">):</span>
                        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;replacing &#39;</span><span class="si">%s</span><span class="s2">&#39; in production function&quot;</span> <span class="o">%</span> <span class="n">item</span><span class="p">)</span>
                        <span class="c1"># string value is replaced with a Pobject reference</span>
                        <span class="n">pr</span><span class="o">.</span><span class="n">prodFunction</span><span class="o">.</span><span class="n">items</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">var</span>
                <span class="c1"># replacing in distribution function</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">distribRule</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">pr</span><span class="o">.</span><span class="n">distribFunction</span><span class="p">):</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">var</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">distribRule</span><span class="o">.</span><span class="n">variable</span><span class="p">):</span>
                        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;replacing &#39;</span><span class="si">%s</span><span class="s2">&#39; in distribution function&quot;</span> <span class="o">%</span> <span class="n">distribRule</span><span class="o">.</span><span class="n">variable</span><span class="p">)</span>
                        <span class="c1"># string value is replaced with a Pobject reference</span>
                        <span class="n">distribRule</span><span class="o">.</span><span class="n">variable</span> <span class="o">=</span> <span class="n">var</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;cross-referencing string identifiers of ENZYMES to the corresponding Pobject instance&quot;</span><span class="p">)</span>
    <span class="c1"># cross-reference string identifiers with references to Pobject instances</span>
    <span class="k">for</span> <span class="n">enz</span> <span class="ow">in</span> <span class="n">system</span><span class="o">.</span><span class="n">enzymes</span><span class="p">:</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">membrane_name</span><span class="p">,</span> <span class="n">membrane</span><span class="p">)</span> <span class="ow">in</span> <span class="n">system</span><span class="o">.</span><span class="n">membranes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;processing membrane </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">membrane_name</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">prg_nr</span><span class="p">,</span> <span class="n">pr</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">membrane</span><span class="o">.</span><span class="n">programs</span><span class="p">):</span>
                <span class="c1"># replace the program enzyme name with reference</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">enz</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">pr</span><span class="o">.</span><span class="n">enzyme</span><span class="p">):</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;replacing &#39;</span><span class="si">%s</span><span class="s2">&#39; as program </span><span class="si">%d</span><span class="s2"> enzyme&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">enz</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">prg_nr</span><span class="p">))</span>
                    <span class="n">pr</span><span class="o">.</span><span class="n">enzyme</span> <span class="o">=</span> <span class="n">enz</span>
                <span class="c1"># replacing in production function</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">pr</span><span class="o">.</span><span class="n">prodFunction</span><span class="o">.</span><span class="n">items</span><span class="p">[:]):</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">enz</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">item</span><span class="p">):</span>
                        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;replacing &#39;</span><span class="si">%s</span><span class="s2">&#39; in production function&quot;</span> <span class="o">%</span> <span class="n">item</span><span class="p">)</span>
                        <span class="c1"># string value is replaced with a Pobject reference</span>
                        <span class="n">pr</span><span class="o">.</span><span class="n">prodFunction</span><span class="o">.</span><span class="n">items</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">enz</span>
                <span class="c1"># replacing in distribution function</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">distribRule</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">pr</span><span class="o">.</span><span class="n">distribFunction</span><span class="p">):</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">enz</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">distribRule</span><span class="o">.</span><span class="n">variable</span><span class="p">):</span>
                        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;replacing &#39;</span><span class="si">%s</span><span class="s2">&#39; in distribution function&quot;</span> <span class="o">%</span> <span class="n">distribRule</span><span class="o">.</span><span class="n">variable</span><span class="p">)</span>
                        <span class="c1"># string value is replaced with a Pobject reference</span>
                        <span class="n">distribRule</span><span class="o">.</span><span class="n">variable</span> <span class="o">=</span> <span class="n">enz</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Constructing the internal membrane structure of the P system&quot;</span><span class="p">)</span>
    <span class="c1"># construct a tree representation of the P system for use for e.g. in membrane dissolution rules</span>
    <span class="c1"># starting from a list of tokens: structure = [1[2]2[3]3]1</span>
    <span class="n">currentMembrane</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">prev_token</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">structure</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1"># iteration starts from the second token (system.structure[1])</span>
    <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">system</span><span class="o">.</span><span class="n">structure</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;ID&#39;</span><span class="p">,</span> <span class="s1">&#39;NUMBER&#39;</span><span class="p">)):</span>
            <span class="c1"># a new branch should be created</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">prev_token</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;L_BRACKET&#39;</span><span class="p">):</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">currentMembrane</span> <span class="o">==</span> <span class="kc">None</span><span class="p">):</span>
                    <span class="n">currentMembrane</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">membranes</span><span class="p">[</span><span class="n">token</span><span class="o">.</span><span class="n">value</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># create a new child membrane</span>
                    <span class="n">currentMembrane</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="n">token</span><span class="o">.</span><span class="n">value</span><span class="p">]</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">membranes</span><span class="p">[</span><span class="n">token</span><span class="o">.</span><span class="n">value</span><span class="p">]</span>
                    <span class="c1"># retain the child membrane&#39;s parent</span>
                    <span class="n">currentMembrane</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="n">token</span><span class="o">.</span><span class="n">value</span><span class="p">]</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">currentMembrane</span>
                    <span class="n">currentMembrane</span> <span class="o">=</span> <span class="n">currentMembrane</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="n">token</span><span class="o">.</span><span class="n">value</span><span class="p">]</span>

            <span class="c1"># a branch should be closed and move one level up</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">prev_token</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;R_BRACKET&#39;</span><span class="p">):</span>
                <span class="n">currentMembrane</span> <span class="o">=</span> <span class="n">currentMembrane</span><span class="o">.</span><span class="n">parent</span>

        <span class="c1"># store previous token</span>
        <span class="n">prev_token</span> <span class="o">=</span> <span class="n">token</span>

    <span class="k">return</span> <span class="n">system</span></div>
<span class="c1"># end readinputfile()</span>

<span class="c1">##########################################################################</span>
<span class="c1">#   MAIN</span>

<span class="k">if</span> <span class="p">(</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">sys</span> <span class="c1"># for argv</span>

    <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;--debug&#39;</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span> <span class="ow">or</span> <span class="s1">&#39;-v&#39;</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">):</span>
        <span class="n">logLevel</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span>
    <span class="k">elif</span> <span class="p">(</span><span class="s1">&#39;--error&#39;</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span> <span class="ow">or</span> <span class="s1">&#39;-v0&#39;</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">):</span>
        <span class="n">logLevel</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">ERROR</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">colorlog</span> <span class="c1"># colors log output</span>

        <span class="n">formatter</span> <span class="o">=</span> <span class="n">colorlog</span><span class="o">.</span><span class="n">ColoredFormatter</span><span class="p">(</span>
                <span class="s2">&quot;</span><span class="si">%(log_color)s%(levelname)-8s</span><span class="s2"> </span><span class="si">%(message)s</span><span class="s2"> </span><span class="si">%(reset)s</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">datefmt</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">reset</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">log_colors</span><span class="o">=</span><span class="p">{</span>
                        <span class="s1">&#39;DEBUG&#39;</span><span class="p">:</span>    <span class="s1">&#39;cyan&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;INFO&#39;</span><span class="p">:</span>     <span class="s1">&#39;green&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;WARNING&#39;</span><span class="p">:</span>  <span class="s1">&#39;yellow&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;ERROR&#39;</span><span class="p">:</span>    <span class="s1">&#39;red&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;CRITICAL&#39;</span><span class="p">:</span> <span class="s1">&#39;red,bg_white&#39;</span><span class="p">,</span>
                <span class="p">},</span>
                <span class="n">secondary_log_colors</span><span class="o">=</span><span class="p">{},</span>
                <span class="n">style</span><span class="o">=</span><span class="s1">&#39;%&#39;</span>
        <span class="p">)</span>

        <span class="n">colorlog</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">stream</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">,</span> <span class="n">level</span> <span class="o">=</span> <span class="n">logLevel</span><span class="p">)</span>
        <span class="n">stream</span> <span class="o">=</span> <span class="n">colorlog</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">handlers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">stream</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">formatter</span><span class="p">);</span>

    <span class="c1"># colorlog not available</span>
    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%(levelname)s</span><span class="s1">:</span><span class="si">%(message)s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">level</span> <span class="o">=</span> <span class="n">logLevel</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">):</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Expected input file path as parameter&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Usage: pep.py PEP_INPUT_FILE [options]&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    [options] can be:&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;        * -n NR: stop the simulation after NR execution steps&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;        * --step:          step-by-step execution&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;        * --csv:           write a Comma Separated Values (CSV) file that contains the values of all Pobjects at each simulation step&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;        * -v | --debug:    increase verbosity&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;        * -v0 | --error:   decrease verbosity&quot;</span><span class="p">)</span>
        <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># step by step simulation</span>
    <span class="n">step</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;--step&#39;</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">):</span>
        <span class="n">step</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="c1"># nr of simulation steps</span>
    <span class="n">nrSteps</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span> <span class="c1"># -2 == undefined, -1 == unlimited</span>
    <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;-n&#39;</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">nrSteps</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;-n&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">IndexError</span><span class="p">):</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Expected a number (of simulation steps) after the &#39;-n&#39; parameter&quot;</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="c1"># if nrSteps still is undefined (-2)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">nrSteps</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">):</span>
                <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">system</span> <span class="o">=</span> <span class="n">readInputFile</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="k">if</span> <span class="p">(</span><span class="s2">&quot;--csv&quot;</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">):</span>
        <span class="n">system</span><span class="o">.</span><span class="n">openCsvFile</span><span class="p">()</span>


    <span class="k">if</span> <span class="p">(</span><span class="n">logLevel</span> <span class="o">&lt;=</span> <span class="n">logging</span><span class="o">.</span><span class="n">WARNING</span><span class="p">):</span>
        <span class="c1"># print the structure of the P system</span>
        <span class="n">system</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">indentSpaces</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">withPrograms</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>


    <span class="n">system</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">stepByStepConfirm</span> <span class="o">=</span> <span class="n">step</span><span class="p">,</span> <span class="n">maxSteps</span> <span class="o">=</span> <span class="n">nrSteps</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">system</span><span class="o">.</span><span class="n">csvFile</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Wrote csv output file </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">system</span><span class="o">.</span><span class="n">csvFile</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">system</span><span class="o">.</span><span class="n">csvFile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">);</span>
</pre></div>

           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Andrei George Florea, Cătălin Buiu.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'1.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>